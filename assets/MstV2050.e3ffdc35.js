import{Q as U}from"./QBar.57bcd1b8.js";import{Q as F}from"./QSpace.601fa16e.js";import{Q as G}from"./QToolbar.b2280906.js";import{r as i,j as $,ab as y,p as L,k as P,o as Z,R as _,a6 as k,Z as r,U as p,n as s,X as l,$ as f,a8 as X,a0 as v,a1 as g,Y as z,a2 as K,bu as ee,bE as te,W as ae,a7 as se}from"./index.796e9a09.js";import{Q as oe}from"./QPage.976dcdc8.js";import{A as le}from"./main.esm.a63d2102.js";import{u as ne}from"./use-quasar.737b824d.js";import{api as B}from"./axios.cdca92d4.js";import{l as w}from"./lodash.78b3cd6a.js";import{j as J,n as re}from"./json-util.11434787.js";import{u as ie}from"./setYearInfo.de2541ce.js";import"./_commonjsHelpers.b8add541.js";const ce={class:"row q-col-gutter-md"},ue={class:"col-12"},de=p("span",{class:"text-subtitle2 q-px-sm"},"\uC9C1\uBD84\uB958\uC815\uBCF4\uB9AC\uC2A4\uD2B8",-1),me={class:"q-gutter-xs"},Ne={__name:"MstV2050",setup(fe){const N=ie(),S=ne(),Q=i(500),O=$(()=>({height:`${Q.value}px`})),d=i(null),o=y({rows:[]}),x=i([]),n=i([]),u=i(!1),h=i(!1);L(()=>{window.removeEventListener("resize",C)}),P(()=>{q.value="multiple",D()}),Z(()=>{window.addEventListener("resize",C),C()});const R=e=>{d.value=e.api},V=y({def:{flex:1,sortable:!0,filter:!0,floatingFilter:!1,editable:!0}}),W=y({columns:[{headerName:"",field:"",maxWidth:50,minWidth:50,checkboxSelection:!0,headerCheckboxSelection:!0,filter:!1,pinned:"left"},{headerName:"\uCF54\uB4DC",field:"catgCd",maxWidth:80,minWidth:80,cellEditorParams:{maxLength:5}},{headerName:"\uC9C1\uBD84\uB958\uBA85",field:"catgNm",maxWidth:150,minWidth:150},{headerName:"\uCC98\uB9AC\uC21C\uC11C",field:"seq",maxWidth:100,minWidth:100,cellEditor:"agNumberCellEditor",cellEditorParams:{precision:2,step:1,showStepperButtons:!0}}]}),m=i(),Y=e=>{m.value=e.api.getSelectedRows(),m.value.length===1?(h.value=!0,u.value=!0):m.value.length>1?(h.value=!0,u.value=!1):h.value=!1},A=()=>{n.value=[];for(let e=0;x.value.length>e;e++)JSON.stringify(x.value[e])!==JSON.stringify(o.rows[e])&&o.rows[e].iuD==="U"&&n.value.push(o.rows[e]);n.value.length>0&&(u.value=!0)},q=i(null),I=()=>{u.value=!0,n.value=[];const e=0,a={stdYear:N.setYear,catgCd:"",oldCatgCd:"",catgNm:"",seq:o.rows.length+1,iuD:"I"};o.rows.splice(e,0,a),d.value.setRowData(o.rows),d.value.setFocusedCell(e,"catgCd")},M=()=>{S.dialog({dark:!0,title:"\uC790\uB8CC\uC0AD\uC81C",message:"\uC120\uD0DD\uB41C \uC790\uB8CC\uB97C \uC0AD\uC81C\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C? ",ok:{push:!0,color:"negative"},cancel:{push:!0,color:"grey-7"}}).onOk(()=>{let e=[],a=[];for(let c=0;c<m.value.length;c++){let T='{"mode":"D","data":'+JSON.stringify(m.value[c])+"}";a.push(T)}b(J.jsonFiller(e,a));const t=d.value.getSelectedRows();d.value.applyTransaction({remove:t})}).onCancel(()=>{}).onDismiss(()=>{})},j=()=>{let e=[],a=[];for(let t=0;t<o.rows.length;t++)if(!w.exports.isEmpty(o.rows[t].catgCd)&&o.rows[t].iuD==="I"){let c='{"mode": "'+o.rows[t].iuD+'","data":'+JSON.stringify(o.rows[t])+"}";e.push(c)}for(let t=0;t<n.value.length;t++)if(!w.exports.isEmpty(n.value[t].catgCd)&&n.value[t].iuD==="U"){let c='{"mode": "'+n.value[t].iuD+'","data":'+JSON.stringify(n.value[t])+"}";e.push(c)}console.log("iu ::: ",JSON.stringify(e)),w.exports.isEmpty(e)&&w.exports.isEmpty(a)?S.dialog({dark:!0,title:"\uC548\uB0B4",message:"\uBCC0\uACBD\uB41C \uC790\uB8CC\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4. "}).onOk(()=>{}).onCancel(()=>{}).onDismiss(()=>{}):(b(J.jsonFiller(e,a)),setTimeout(()=>{D()},500))},E=i(0),H=e=>(E.value=e,{minHeight:e?`calc(100vh - ${e}px)`:"100vh"}),C=()=>{Q.value=window.innerHeight-E.value-180},D=async()=>{try{const e=await B.post("/api/mst/mst2050_list",{paramSetYear:N.setYear});o.rows=e.data.data,x.value=JSON.parse(JSON.stringify(e.data.data)),n.value=[]}catch(e){console.error("Error fetching users:",e)}},b=e=>{B.post("/api/mst/mst2050_save",e).then(a=>{let t={};a.data.rtn==="0"?(t.rtn=1,t.rtn1=a.data.rtnMsg1,t.rtn2="\uC790\uB8CC\uC800\uC7A5 \uC644\uB8CC"):(t.rtn=a.data.rtn,t.rtn1=a.data.rtnMsg1,t.rtn2=a.data.rtnMsg2),u.value=!1,re.notifyView(t)}).catch(a=>{console.log("error: ",a)})};return(e,a)=>(_(),k(oe,{class:"q-pa-xs-xs q-pa-sm-md","style-fn":H},{default:r(()=>[p("div",ce,[p("div",ue,[s(se,{bordered:""},{default:r(()=>[s(U,{class:"q-px-sm"},{default:r(()=>[s(l(f),{name:"list_alt"}),de]),_:1}),s(X,{align:"right",class:"q-pa-none"},{default:r(()=>[s(G,{class:"row"},{default:r(()=>[s(l(v),{outline:"",color:"positive",dense:"",onClick:D},{default:r(()=>[s(l(f),{name:"refresh",size:"xs",class:"q-mr-sm"}),g("\uB2E4\uC2DC\uBD88\uB7EC\uC624\uAE30")]),_:1}),s(F),p("div",me,[h.value?(_(),k(l(v),{key:0,outline:"",color:"negative",dense:"",onClick:M},{default:r(()=>[s(l(f),{name:"delete",size:"xs"}),g(" \uC0AD\uC81C")]),_:1})):z("",!0),u.value?(_(),k(l(v),{key:1,outline:"",color:"primary",dense:"",onClick:j},{default:r(()=>[s(l(f),{name:"save",size:"xs"}),g(" \uC800\uC7A5 ")]),_:1})):z("",!0),s(l(v),{outline:"",color:"positive",dense:"",onClick:I},{default:r(()=>[s(l(f),{name:"add",size:"xs"}),g(" \uC2E0\uADDC ")]),_:1})])]),_:1})]),_:1}),s(K,{size:"3px"}),s(ee,{class:"q-pa-xs"},{default:r(()=>[p("div",{style:te(O.value)},[s(l(le),{ref:"myGrid",style:{width:"100%",height:"100%"},class:ae(l(S).dark.isActive?"ag-theme-alpine-dark":"ag-theme-alpine"),columnDefs:W.columns,rowData:o.rows,defaultColDef:V.def,rowSelection:q.value,onSelectionChanged:Y,onCellValueChanged:A,onGridReady:R},null,8,["class","columnDefs","rowData","defaultColDef","rowSelection"])],4)]),_:1})]),_:1})])])]),_:1}))}};export{Ne as default};
