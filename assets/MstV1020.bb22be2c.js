import{Q as Ce}from"./QBanner.ac724ef6.js";import{Q as H}from"./QSpace.601fa16e.js";import{ab as Q,r as s,w as ke,j as Ne,p as qe,k as Re,o as Qe,R as c,a6 as D,Z as r,n as l,U as i,W as O,X as n,$ as x,a1 as b,a7 as I,a2 as Y,bu as T,a0 as C,bE as te,S as k,Y as p,V as Oe,a5 as ae}from"./index.796e9a09.js";import{Q as ze}from"./QItemLabel.c03d9e19.js";import{Q as le}from"./QToolbar.b2280906.js";import{Q as Ve}from"./QBadge.d49aff15.js";import{Q as Ae}from"./QSelect.a2b6cad7.js";import{Q as Ee}from"./QPage.976dcdc8.js";import{A as oe}from"./main.esm.a63d2102.js";import{l as We}from"./lodash.78b3cd6a.js";import{api as z}from"./axios.cdca92d4.js";import{j as B,n as Ge}from"./json-util.11434787.js";import{u as He}from"./use-quasar.737b824d.js";import{u as Ie}from"./setUserInfo.024a2a24.js";import{u as Ye}from"./setYearInfo.de2541ce.js";import"./QField.e93cf12f.js";import"./QChip.56e9ec7c.js";import"./QItemSection.ae9ab285.js";import"./QMenu.c288f19f.js";import"./position-engine.adea6890.js";import"./selection.e36e704c.js";import"./rtl.276c3f1b.js";import"./_commonjsHelpers.b8add541.js";const Te={class:"row"},Be={class:"col-xs-12 col-lg-12"},Fe=i("span",{class:"text-subtitle1 text-bold"}," \uC5ED\uB7C9\uD3C9\uAC00 \uAE30\uC900 \uD56D\uBAA9\uC815\uC758 \uC124\uC815 \uC791\uC5C5\uC785\uB2C8\uB2E4.",-1),Je=i("br",null,null,-1),Me=i("br",null,null,-1),Ue=i("br",null,null,-1),Le={class:"row"},je={class:"col-xs-2"},$e={class:"q-gutter-xs"},Pe={class:"col-xs-10"},Ze={key:0,class:"q-ml-xs"},Ke={key:0,class:"q-ml-xs"},Xe={key:0,class:"q-ml-xs"},et={key:0,class:"q-ml-xs"},tt={class:"row q-col-gutter-x-xl"},at={class:"col-2"},lt={class:"col-8"},ot={class:"col-2"},st=46,Qt={__name:"MstV1020",setup(nt){Ie();const N=Ye(),g=Q({rows:[],rowsSel:[]}),V=s(300),F=s(135);ke(()=>g.rows,e=>{const t=e.length*st;V.value=F.value+t},{immediate:!0});const d=He(),y=s(null),J=s(0),M=s(300);Ne(()=>({height:`${M.value}px`}));const U=s(null),L=s(null),A=s(null),q=s(null),f=s(null),se=e=>{q.value=e.api,q.value.setGridOption("headerHeight",45),q.value.setGridOption("rowHeight",45),q.value.deselectAll()},ne=e=>{f.value=e.api,f.value.setGridOption("headerHeight",45),f.value.setGridOption("rowHeight",45),re(),f.value.deselectAll()},j=Q({defSel:{flex:1,sortable:!0,filter:!1,floatingFilter:!1,editable:!1},def:{flex:1,sortable:!0,filter:!0,floatingFilter:!1,editable:!1}}),$=Q({sel:[{headerName:"#",width:60,pinned:"left",valueGetter:function(e){return e.node.rowIndex+1}},{headerName:"\uBD84\uB958\uD56D\uBAA9",field:"commNm",sortable:!0,filter:!1,cellStyle:{textAlign:"center"}}],columns:[{headerName:"",field:"",sortable:!1,filter:!1,maxWidth:60,minWidth:60,pinned:"left",cellStyle:{textAlign:"center"},checkboxSelection:!0,headerCheckboxSelection:!0},{headerName:"No",field:"seq",rowDrag:!0,maxWidth:80,minWidth:80},{headerName:"\uD3C9\uAC00\uBD84\uB958",field:"divNm",minWidth:150,maxWidth:150,resizable:!0},{headerName:"\uD3C9\uAC00\uD56D\uBAA9\uBA85",field:"itemNm",minWidth:200,resizable:!0},{headerName:"\uAC00\uC911\uCE58",field:"weight",maxWidth:95,minWidth:95,resizable:!1,cellStyle:e=>d.dark.isActive?{color:"cyan",fontWeight:"700"}:{color:"blue",fontWeight:"700"}}]}),m=s(0),re=()=>{m.value=0,g.rows.forEach(t=>{m.value+=t.weight});const e=[{itemNm:"\uD569\uACC4",weight:m.value}];f.value.updateGridOptions({pinnedBottomRowData:e})};Q({evsGroup:{empCd:"",empNm:"",deptCd:"",deptNm:"",titlCd:"",titlNm:""},evtGroup:{empCd:"",empNm:"",deptCd:"",deptNm:"",titlCd:"",titlNm:""}}),qe(()=>{window.removeEventListener("resize",E)}),Re(()=>{L.value="single",U.value="multiple",K("202"),setTimeout(()=>{K("203")},500)}),Qe(()=>{window.addEventListener("resize",E),E()});const R=s(null),a=s({stdYear:"",itemFg:"",itemCd:"",divCd:"",itemNm:"",seq:0,weight:0,iuD:""}),ie=()=>{a.value.stdYear=N.setYear,a.value.itemFg=h.value[0].commCd,a.value.itemCd="",a.value.divCd="",a.value.itemNm="",a.value.seq=1,a.value.weight=0,a.value.iuD="I"},ue=()=>{f.value.deselectAll(),setTimeout(()=>{ie(),R.value=a,a.value.weight=100-m.value,a.value.status="0",y.value="I",S.value=!1,v.value=!1,a.value.stdYear=N.setYear,a.value.itemFg=h.value[0].commCd,setTimeout(()=>{A.value.focus()},100)},100)},de=()=>{R.value=a,a.value.weight=100-m.value,y.value="I",v.value=!1,a.value.stdYear=N.setYear,setTimeout(()=>{A.value.focus()},100)},h=s([]),u=s([]),S=s(!0),v=s(!0),ce=e=>{h.value=e.api.getSelectedRows(),console.log("aaa : ",JSON.stringify(h.value)),h.value.length>0&&W(h.value[0].commCd)},me=e=>{u.value=e.api.getSelectedRows(),S.value=!0,u.value.length===1?(S.value=!1,v.value=!1,ye(u.value[0].stdYear,u.value[0].itemFg,u.value[0].itemCd)):(a.value={},y.value="",v.value=!0)},ve=e=>{},pe=e=>{},ge=e=>{const t=[];f.value.forEachNode(_=>t.push(_.data));let o=[],w=[];for(let _=0;_<t.length;_++){t[_].seq=_+1;let De='{"mode": "N", "data":'+JSON.stringify(t[_])+"}";o.push(De)}G(B.jsonFiller(o,w))},fe=e=>{console.log("onRowDragLeave...")},P=s(0),he=e=>(P.value=e,{minHeight:e?`calc(100vh - ${e}px)`:"100vh"}),E=()=>{M.value=window.innerHeight-P.value-520},we=()=>{We.exports.isEqual(a.value,R.value)?d.dialog({dark:!0,title:"\uC548\uB0B4",message:"\uBCC0\uACBD\uB41C \uC790\uB8CC\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4. "}).onOk(()=>{}).onCancel(()=>{}).onDismiss(()=>{}):(console.log("save data::: ",JSON.stringify(a.value)),G(B.dataJsonParse(y.value,a.value)))},_e=()=>{d.dialog({dark:!0,title:"\uC790\uB8CC\uC0AD\uC81C",message:"\uC120\uD0DD\uB41C \uC790\uB8CC\uB97C \uC0AD\uC81C\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C? ",ok:{push:!0,color:"negative"},cancel:{push:!0,color:"grey-7"}}).onOk(()=>{let e=[],t=[];for(let o=0;o<u.value.length;o++){let w='{"mode":"D","data":'+JSON.stringify(u.value[o])+"}";console.log("delete : ",JSON.stringify(u.value[o])),t.push(w)}G(B.jsonFiller(e,t))}).onCancel(()=>{}).onDismiss(()=>{})},Z=s([]);s(null);const K=async e=>{try{const t=await z.post("/api/mst/comm_option_list",{paramCommCd1:e});switch(e){case"202":g.rowsSel=t.data.data;break;case"203":Z.value=t.data.data;break;default:break}console.log("getData1: ",JSON.stringify(t.data.data))}catch(t){console.error("Error fetching users:",t)}},W=async e=>{try{const t=await z.post("/api/mst/mst1020_list",{paramSetYear:N.setYear,paramItemFg:e});g.rows=t.data.data,g.rows.length>0&&(F.value=90),J.value+=1}catch(t){console.error("Error fetching users:",t)}},X=s(0),ye=async(e,t,o)=>{console.log("aa ::: ",e,t,o);try{const w=await z.post("/api/mst/mst1020_select",{paramStdYear:e,paramItemFg:t,paramItemCd:o});a.value=w.data.data[0],R.value=JSON.parse(JSON.stringify(a.value)),X.value=a.value.weight,y.value="U",v.value=!1}catch(w){console.error("Error fetching users:",w)}},G=e=>{z.post("/api/mst/mst1020_save",e).then(t=>{let o={};o.rtn=t.data.rtn,o.rtnMsg=t.data.rtnMsg,Ge.notifyView(o),W(h.value[0].commCd)}).catch(t=>{console.log("error: ",t)})},ee=s(0),Se=()=>{const e=new TextEncoder;ee.value=e.encode(a.value.targetDoc).length},xe={localeText:{noRowsToShow:"\uC870\uD68C \uACB0\uACFC\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4."}},be={getRowStyle:e=>{if(e.node.rowPinned)return{backgroundColor:"lightblue"}},localeText:{noRowsToShow:"\uC870\uD68C \uACB0\uACFC\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4."}};return(e,t)=>(c(),D(Ee,{class:"q-pa-xs-xs q-pa-sm-md","style-fn":he},{default:r(()=>[l(I,{class:"q-pa-sm"},{default:r(()=>[i("div",Te,[i("div",Be,[l(Ce,{rounded:"",class:O(n(d).dark.isActive?"bg-grey-9":"bg-grey-3")},{avatar:r(()=>[l(n(x),{name:"menu_book",color:"primary",size:"md"})]),default:r(()=>[Fe,Je,b(" 1. \uBA3C\uC800 \uD3C9\uAC00\uB300\uC0C1\uD56D\uBAA9\uC744 \uC120\uD0DD\uD558\uACE0 \uAC01 \uD56D\uBAA9\uBA85\uC744 \uB4F1\uB85D\uD558\uC2ED\uC2DC\uC694."),Me,b(" 2. \uAC00\uC911\uCE58\uB294 \uD569\uC774 100\uC744 \uB118\uC5B4\uC124\uC218\uB294 \uC5C6\uC2B5\uB2C8\uB2E4."),Ue]),_:1},8,["class"])]),l(H)])]),_:1}),l(Y,{spaced:""}),l(I,null,{default:r(()=>[l(T,{class:O(["text-center q-pa-sm",n(d).dark.isActive?"bg-teal-7":"bg-teal-3"])},{default:r(()=>[l(ze,{class:"text-h6"},{default:r(()=>[b("\uC5ED\uB7C9\uD3C9\uAC00 \uAE30\uC900 \uD56D\uBAA9\uC815\uC758")]),_:1})]),_:1},8,["class"]),l(Y,{size:"3px",class:"q-mb-xs"}),i("div",Le,[i("div",je,[l(T,null,{default:r(()=>[l(le,{class:"row q-pa-none"},{default:r(()=>[i("div",$e,[l(n(C),{outline:"",color:"grey",dense:"",onClick:W},{default:r(()=>[l(n(x),{name:"refresh",size:"xs",class:"q-mr-xs"}),b(" \uB2E4\uC2DC \uBD88\uB7EC\uC624\uAE30 ")]),_:1})]),l(H)]),_:1}),i("div",{style:te({height:V.value+"px"})},[l(n(oe),{style:{width:"100%",height:"100%"},class:O(n(d).dark.isActive?"ag-theme-alpine-dark":"ag-theme-alpine"),columnDefs:$.sel,rowData:g.rowsSel,defaultColDef:j.defSel,rowSelection:L.value,onSelectionChanged:ce,onGridReady:se,"grid-options":xe},null,8,["class","columnDefs","rowData","defaultColDef","rowSelection"])],4)]),_:1})]),i("div",Pe,[l(T,null,{default:r(()=>[l(le,{class:"row q-pa-none q-gutter-x-xs"},{default:r(()=>[l(H),m.value<100&&u.value.length===1?(c(),D(n(C),{key:0,outline:"",color:"grey",dense:"",onClick:de},{default:r(()=>[l(n(x),{name:"add_to_photos",size:"xs",class:"q-pr-xs"}),n(d).screen.xs?p("",!0):(c(),k("span",Ze," \uBCF5\uC0AC "))]),_:1})):p("",!0),m.value<100?(c(),D(n(C),{key:1,outline:"",color:"grey",dense:"",onClick:ue},{default:r(()=>[l(n(x),{name:"add",size:"xs",class:"q-pr-xs"}),n(d).screen.xs?p("",!0):(c(),k("span",Ke," \uC2E0\uADDC "))]),_:1})):p("",!0),u.value.length===1||y.value==="I"?(c(),D(n(C),{key:2,outline:"",color:"blue-12",dense:"",onClick:we},{default:r(()=>[l(n(x),{name:"save",size:"xs",class:"q-pr-xs"}),n(d).screen.xs?p("",!0):(c(),k("span",Xe,"\uC800\uC7A5"))]),_:1})):p("",!0),u.value.length>0?(c(),D(n(C),{key:3,outline:"",color:"red",dense:"",onClick:_e,class:"q-pr-md"},{default:r(()=>[l(Ve,{color:"orange",floating:""},{default:r(()=>[b(Oe(u.value.length),1)]),_:1}),l(n(x),{name:"delete",size:"xs",class:"q-pr-xs"}),b(),n(d).screen.xs?p("",!0):(c(),k("span",et," \uC0AD\uC81C "))]),_:1})):p("",!0)]),_:1}),(c(),k("div",{key:J.value,style:te({height:V.value+"px"})},[l(n(oe),{style:{width:"100%",height:"100%"},class:O(n(d).dark.isActive?"ag-theme-alpine-dark":"ag-theme-alpine"),columnDefs:$.columns,rowData:g.rows,defaultColDef:j.def,rowSelection:U.value,onSelectionChanged:me,onGridReady:ne,"grid-options":be,rowDragManaged:!0,animateRows:!0,onRowDragMove:ve,onRowDragEnd:ge,onRowDragEnter:pe,onRowDragLeave:fe},null,8,["class","columnDefs","rowData","defaultColDef","rowSelection"])],4)),l(Y,{spaced:""}),l(I,{class:"q-pa-lg"},{default:r(()=>[i("div",tt,[i("div",at,[l(Ae,{readonly:S.value,disable:v.value,"stack-label":"","options-dense":"","label-color":"orange",modelValue:a.value.divCd,"onUpdate:modelValue":t[0]||(t[0]=o=>a.value.divCd=o),options:Z.value,"option-value":"commCd","option-label":"commNm","option-disable":"inactive","emit-value":"","map-options":"",label:"\uD56D\uBAA9\uBD84\uB958"},null,8,["readonly","disable","modelValue","options"])]),i("div",lt,[l(ae,{ref_key:"focusStart",ref:A,readonly:S.value,disable:v.value,modelValue:a.value.itemNm,"onUpdate:modelValue":[t[1]||(t[1]=o=>a.value.itemNm=o),Se],clearable:"",type:"text",color:"orange-13","label-color":"orange-13",label:"\uD3C9\uAC00\uD56D\uBAA9\uBA85",hint:`${ee.value} / 100\uC790 \uAE4C\uC9C0 \uC785\uB825\uD558\uC2E4 \uC218 \uC788\uC2B5\uB2C8\uB2E4.`},null,8,["readonly","disable","modelValue","hint"])]),i("div",ot,[l(ae,{readonly:S.value,disable:v.value,modelValue:a.value.weight,"onUpdate:modelValue":t[2]||(t[2]=o=>a.value.weight=o),type:"number",color:"pink-12","label-color":"pink-12",label:"\uAC00\uC911\uCE58",hint:"\uAC00\uC911\uCE58\uB97C \uC124\uC815\uD558\uC138\uC694",rules:[o=>m.value-X.value+parseInt(o)<=100||"\uAC00\uC911\uCE58\uD569\uC774 100\uC774 \uB118\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."]},null,8,["readonly","disable","modelValue","rules"])])])]),_:1})]),_:1})])])]),_:1})]),_:1}))}};export{Qt as default};
