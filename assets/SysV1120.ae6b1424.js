import{Q as w}from"./QSpace.601fa16e.js";import{Q as R}from"./QBar.57bcd1b8.js";import{Q as ce}from"./QSelect.a2b6cad7.js";import{r as n,R as x,S as Z,n as a,bO as me,j as pe,ab as p,p as fe,k as he,o as ve,bt as B,a6 as k,Z as o,U as i,X as r,$ as g,a8 as E,a5 as ge,Y as V,a0 as G,a1 as O,a2 as $,bu as H,bE as T,W as j,a7 as J,V as M}from"./index.796e9a09.js";import{Q as F}from"./QToolbar.b2280906.js";import{Q as xe}from"./QPage.976dcdc8.js";import{A as P}from"./main.esm.a63d2102.js";import{u as L}from"./use-quasar.737b824d.js";import{api as U}from"./axios.cdca92d4.js";import{l as q}from"./lodash.78b3cd6a.js";import{j as ye,n as _e}from"./json-util.11434787.js";import{u as we}from"./setYearInfo.de2541ce.js";import"./QField.e93cf12f.js";import"./QChip.56e9ec7c.js";import"./QItemSection.ae9ab285.js";import"./QItemLabel.c03d9e19.js";import"./QMenu.c288f19f.js";import"./position-engine.adea6890.js";import"./selection.e36e704c.js";import"./rtl.276c3f1b.js";import"./_commonjsHelpers.b8add541.js";const Se={__name:"CompToggleAuth",props:["params"],setup(Q){L();const f=Q,{updateSelectedValue:c}=f.params,d=n(f.params.data),u=()=>{c(d)};return(S,h)=>(x(),Z("div",null,[a(me,{size:"sm",color:"blue-14","true-value":"Y","false-value":"N",modelValue:d.value.targetYn,"onUpdate:modelValue":[h[0]||(h[0]=N=>d.value.targetYn=N),u]},null,8,["modelValue"])]))}},Ne={class:"row q-col-gutter-md"},be={class:"col-12 col-lg-6"},De=i("span",{class:"text-subtitle2 q-px-sm"},"\uC0AC\uC6A9\uC815\uBCF4 \uB9AC\uC2A4\uD2B8",-1),We={class:"row q-col-gutter-md"},Ce={class:"q-gutter-xs"},ke={class:"col-12 col-lg-6"},Ve=i("span",{class:"text-subtitle2 q-px-sm"},"\uAD8C\uD55C\uBC1B\uB294 \uC0AC\uC6A9\uC790 \uB9AC\uC2A4\uD2B8",-1),Ue={key:0},qe=i("span",{class:"text-subtitle1 text-bold"},"\uC8FC\uB294\uCABD : ",-1),Qe={class:"text-subtitle1 text-bold"},Ye={class:"q-gutter-xs"},tt={__name:"SysV1120",setup(Q){const f=we(),c=L(),d=n(""),u=n(""),S=n(500),h=pe(()=>({height:`${S.value}px`})),N=n(null),X=n(null),y=p({rows:[]}),v=p({rows:[]});fe(()=>{window.removeEventListener("resize",b)}),he(()=>{A.value="single",D()}),ve(()=>{window.addEventListener("resize",b),b(),ue()});const K=e=>{X.value=e.api},ee=p({def:{flex:1,sortable:!1,filter:!1,floatingFilter:!1,editable:!1}}),te=p({columns:[{headerName:"#",minWidth:60,maxWidth:60,pinned:"left",cellStyle:{textAlign:"center"},valueGetter:function(e){return e.node.rowIndex+1}},{headerName:"\uC8FC\uB294\uCABD",field:"",maxWidth:70,minWidth:70,pinned:"left",cellStyle:{textAlign:"center"},checkboxSelection:!0},{headerName:"\uBC1B\uB294\uCABD",field:"targetYn",maxWidth:70,minWidth:70,pinned:"left",cellRenderer:Se,cellRendererParams:{updateSelectedValue:e=>{q.exports.isEmpty(u.value)?(e.value.targetYn="N",c.dialog({dark:!0,title:"\uC548\uB0B4",message:"\uC8FC\uB294\uCABD\uC744 \uBA3C\uC800 \uC120\uD0DD\uD558\uC138\uC694"})):e.value.targetYn==="Y"&&u.value===e.value.targetUserId?(B.create({type:"my-notify",position:"top-right",color:"negative",message:"\uC8FC\uB294\uCABD ID\uC640 \uBC1B\uB294\uCABD ID\uAC00 \uAC19\uC73C\uBA74 \uC548\uB429\uB2C8\uB2E4.",group:!1,actions:[{label:"\uB2EB\uAE30",color:"dark",handler:()=>{}}],timeout:5e3}),e.value.targetYn="N"):I()}}},{headerName:"\uC544\uC774\uB514",field:"userId",maxWidth:100,minWidth:100,pinned:"left"},{headerName:"\uC131\uBA85",field:"userNm",minWidth:100,maxWidth:100,pinned:"left"},{headerName:"\uC18C\uC18D\uD300",field:"deptNm",maxWidth:100,minWidth:100},{headerName:"\uC9C1\uC704",field:"pstnNm",maxWidth:100,minWidth:100},{headerName:"\uC0AC\uC6D0\uBC88\uD638",field:"empCd",maxWidth:100,minWidth:100,cellStyle:{textAlign:"center"}}]}),ae=e=>{N.value=e.api},se=p({def:{flex:1,sortable:!1,filter:!1,floatingFilter:!1,editable:!1}}),le=p({columns:[{headerName:"#",minWidth:60,maxWidth:60,cellStyle:{textAlign:"center"},valueGetter:function(e){return e.node.rowIndex+1}},{headerName:"\uC544\uC774\uB514",field:"targetUserId",maxWidth:100,minWidth:100},{headerName:"\uC131\uBA85",field:"userNm",minWidth:100,maxWidth:100},{headerName:"\uC18C\uC18D\uD300",field:"deptNm",maxWidth:100,minWidth:100},{headerName:"\uC9C1\uC704",field:"pstnNm",maxWidth:100,minWidth:100},{headerName:"\uC0AC\uC6D0\uBC88\uD638",field:"empCd",maxWidth:100,minWidth:100,cellStyle:{textAlign:"center"}}]}),m=n(),Y=n(!1),oe=e=>{if(m.value=e.api.getSelectedRows(),!q.exports.isEmpty(m.value)){u.value=m.value[0].sourceUserId;for(let t=0;l.value.length>t;t++)u.value===l.value[t].targetUserId&&(y.rows[t].targetYn="N");I()}},I=()=>{l.value=[];for(let t=0;v.rows.length>t;t++)v.rows[t].targetYn==="Y"&&l.value.push(v.rows[t]);y.rows=l.value,console.log(JSON.stringify(y.rows)),Y.value=l.value.length>0;let e=null;l.value.length>0&&(e=l.value.length+" \uBA85\uC774 \uC120\uD0DD \uB418\uC5C8\uC2B5\uB2C8\uB2E4.",B.create({type:"my-notify",position:"bottom",color:"primary",message:e,group:!1,actions:[{label:"\uB2EB\uAE30",color:"dark",handler:()=>{}}],timeout:5e3}))},A=n(null),l=n([]),ne=n(!1),re=()=>{for(let s=0;s<l.value.length;s++)l.value[s].sourceUserId=u.value;let e=[],t=[];for(let s=0;s<l.value.length;s++){let _;_='{"mode": "I","data":'+JSON.stringify(l.value[s])+"}",e.push(_),_='{"mode": "D","data":'+JSON.stringify(l.value[s])+"}",t.push(_)}l.value.length<=0?c.dialog({dark:!0,title:"\uC548\uB0B4",message:"\uBCC0\uACBD\uB41C \uC790\uB8CC\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4. "}).onOk(()=>{}).onCancel(()=>{}).onDismiss(()=>{}):de(ye.jsonFiller(e,t))},z=n(0),ie=e=>(z.value=e,{minHeight:e?`calc(100vh - ${e}px)`:"100vh"}),b=()=>{S.value=window.innerHeight-z.value-180},D=async()=>{try{const e=await U.post("/api/sys/sys1120_list",{paramSetYear:f.setYear,paramDeptCd:C.value,paramSearchValue:d.value});v.rows=e.data.data}catch(e){console.error("Error fetching users:",e)}},de=e=>{U.post("/api/sys/sys1120_save",e).then(t=>{ne.value=!1;let s={};s.rtn=t.data.rtn,s.rtnMsg=t.data.rtnMsg,_e.notifyView(s)}).catch(t=>{console.log("error: ",t)})},W=n([]),C=n("");async function ue(e){try{const t=await U.post("/api/mst/dept_option_list",{paramSetYear:f.setYear});W.value=t.data.data,W.value.push({deptCd:"",deptNm:"\uC804\uCCB4"})}catch(t){console.error("Error fetching users:",t)}}return(e,t)=>(x(),k(xe,{class:"q-pa-xs-xs q-pa-sm-md","style-fn":ie},{default:o(()=>[i("div",Ne,[i("div",be,[a(J,{bordered:""},{default:o(()=>[a(R,{class:"q-px-sm"},{default:o(()=>[a(r(g),{name:"list_alt"}),De,a(w)]),_:1}),a(E,{align:"right",class:"q-pa-none"},{default:o(()=>[a(F,{class:"row"},{default:o(()=>[i("div",We,[a(ce,{dense:"","stack-label":"","options-dense":"",class:"q-px-md q-mr-sm","label-color":"orange",modelValue:C.value,"onUpdate:modelValue":[t[0]||(t[0]=s=>C.value=s),D],options:W.value,"option-value":"deptCd","option-label":"deptNm","option-disable":"inactive","emit-value":"","map-options":"",style:{"min-width":"150px","max-width":"150px"},label:"\uC18C\uC18D\uD300"},null,8,["modelValue","options"]),a(ge,{"stack-label":"","label-color":"orange","bottom-slots":"",modelValue:d.value,"onUpdate:modelValue":t[2]||(t[2]=s=>d.value=s),label:"\uAC80\uC0C9",dense:"",class:"q-pb-none",style:{width:"120px"}},{append:o(()=>[d.value!==""?(x(),k(r(g),{key:0,name:"close",onClick:t[1]||(t[1]=s=>d.value=""),class:"cursor-pointer"})):V("",!0)]),_:1},8,["modelValue"])]),a(w),i("div",Ce,[a(r(G),{outline:"",color:"positive",dense:"",onClick:D},{default:o(()=>[a(r(g),{name:"search",size:"xs"}),O(" \uC870\uD68C ")]),_:1})])]),_:1})]),_:1}),a($,{size:"3px"}),a(H,{class:"q-pa-xs"},{default:o(()=>[i("div",{style:T(h.value)},[a(r(P),{style:{width:"100%",height:"100%"},class:j(r(c).dark.isActive?"ag-theme-alpine-dark":"ag-theme-alpine"),columnDefs:te.columns,rowData:v.rows,defaultColDef:ee.def,rowSelection:A.value,onSelectionChanged:oe,onGridReady:K},null,8,["class","columnDefs","rowData","defaultColDef","rowSelection"])],4)]),_:1})]),_:1})]),i("div",ke,[a(J,{bordered:""},{default:o(()=>[a(R,{class:"q-px-sm"},{default:o(()=>[a(r(g),{name:"list_alt"}),Ve,a(w)]),_:1}),a(E,{align:"right",class:"q-pa-none"},{default:o(()=>[a(F,{class:"row"},{default:o(()=>[r(q.exports.isEmpty)(m.value)?V("",!0):(x(),Z("div",Ue,[qe,i("span",Qe," ( "+M(m.value[0].userId)+" ) "+M(m.value[0].userNm),1)])),a(w),i("div",Ye,[Y.value?(x(),k(r(G),{key:0,outline:"",color:"primary",dense:"",onClick:re},{default:o(()=>[a(r(g),{name:"content_copy",size:"xs",class:"q-mr-sm"}),O(" \uAD8C\uD55C\uBCF5\uC0AC \uC2DC\uC791")]),_:1})):V("",!0)])]),_:1})]),_:1}),a($,{size:"3px"}),a(H,{class:"q-pa-xs"},{default:o(()=>[i("div",{style:T(h.value)},[a(r(P),{style:{width:"100%",height:"100%"},class:j(r(c).dark.isActive?"ag-theme-alpine-dark":"ag-theme-alpine"),columnDefs:le.columns,rowData:y.rows,defaultColDef:se.def,onGridReady:ae},null,8,["class","columnDefs","rowData","defaultColDef"])],4)]),_:1})]),_:1})])])]),_:1}))}};export{tt as default};
