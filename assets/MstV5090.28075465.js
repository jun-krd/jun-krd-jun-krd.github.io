import{Q as $}from"./QBar.57bcd1b8.js";import{Q as Y}from"./QSpace.601fa16e.js";import{Q as L}from"./QToolbar.b2280906.js";import{r as i,R as x,S as ye,n as a,bO as De,ab as w,j as _e,k as Ne,p as ke,o as Ge,a6 as D,Z as n,U as f,X as s,$ as p,a8 as Z,a0 as h,a1 as _,Y as b,a2 as X,bu as K,bE as ee,W as te,a7 as ae,V as le}from"./index.796e9a09.js";import{Q as be}from"./QPage.976dcdc8.js";import{A as oe}from"./main.esm.a63d2102.js";import{u as We}from"./use-quasar.737b824d.js";import{api as V}from"./axios.cdca92d4.js";import{l as g}from"./lodash.78b3cd6a.js";import{j as z,n as se}from"./json-util.11434787.js";import"./_commonjsHelpers.b8add541.js";const ne={__name:"CompToggle",props:["params"],setup(I){i(null);const v=I,{updateSelectedValue:W}=v.params,S=i(v.params.data),C=()=>{W(S)};return(y,u)=>(x(),ye("div",null,[a(De,{size:"sm",color:"secondary","true-value":"Y","false-value":"N",modelValue:S.value.useYn,"onUpdate:modelValue":[u[0]||(u[0]=N=>S.value.useYn=N),C]},null,8,["modelValue"])]))}},Je={class:"row q-col-gutter-md"},Oe={class:"col-12 col-lg-5"},Ee=f("span",{class:"text-subtitle2 q-px-sm"},"\uACF5\uD1B5\uAE30\uC900\uCF54\uB4DC Header \uB9AC\uC2A4\uD2B8",-1),Re={class:"q-gutter-xs"},Ve={class:"col-12 col-lg-7"},ze=f("span",{class:"text-subtitle2 q-px-sm"},"\uACF5\uD1B5\uAE30\uC900\uCF54\uB4DC Detail \uB9AC\uC2A4\uD2B8",-1),Qe={class:"q-ml-lg text-subtitle1 text-bold"},qe={class:"q-gutter-xs"},$e={__name:"MstV5090",setup(I){const v=We();w({deptCd:"",word:""});const W=i(500),S=_e(()=>({height:`${W.value}px`})),C=i(null),y=i(null),u=w({rows:[]}),N=i([]),d=w({rows:[]}),Q=i([]);i(null);const o=i([]),J=i(!1),O=i(!1),k=i(!1),E=i(!1),R=i(!1),c=i({commCd1:"",commNm:""}),ie=e=>{C.value=e.api},re=w({def:{flex:1,sortable:!0,filter:!0,floatingFilter:!1,editable:!0}}),ue=w({columns:[{headerName:"",field:"",maxWidth:50,minWidth:50,checkboxSelection:!0,headerCheckboxSelection:!0,filter:!1,pinned:"left"},{headerName:"\uCF54\uB4DC",field:"commCd1",maxWidth:80,minWidth:80,cellEditorParams:{maxLength:3}},{headerName:"\uADF8\uB8F9\uCF54\uB4DC\uBA85",field:"commNm",minWidth:130,maxWidth:130},{headerName:"\uB4F1\uB85D\uC218",field:"cnt",minWidth:90,maxWidth:90,editable:!1,cellStyle:{textAlign:"center"}},{headerName:"\uC0AC\uC6A9",field:"useYn",maxWidth:80,minWidth:80,editable:!1,cellStyle:{textAlign:"center"},cellRenderer:ne,cellRendererParams:{updateSelectedValue:e=>{T()}}},{headerName:"\uCC38\uACE0\uC0AC\uD56D",field:"explains",minWidth:100,cellStyle:{textAlign:"center"}}]}),de=e=>{y.value=e.api},ce=w({def:{flex:1,sortable:!0,filter:!0,floatingFilter:!1,editable:!0}}),me=w({columns:[{headerName:"",field:"",maxWidth:50,minWidth:50,checkboxSelection:!0,headerCheckboxSelection:!0,filter:!1,pinned:"left"},{headerName:"\uCF54\uB4DC",field:"commCd2",maxWidth:100,minWidth:100,cellEditorParams:{maxLength:5}},{headerName:"\uD56D\uBAA9\uBA85",field:"commNm",minWidth:150},{headerName:"\uBCF4\uC870\uD56D\uBAA9",field:"commEtc",minWidth:100},{headerName:"\uC0AC\uC6A9",field:"useYn",maxWidth:100,minWidth:100,editable:!1,cellStyle:{textAlign:"center"},cellRenderer:ne,cellRendererParams:e=>({updateSelectedValue:l=>{U()}})},{headerName:"\uCC38\uACE0\uC0AC\uD56D",field:"explains",maxWidth:100,minWidth:100,cellStyle:{textAlign:"center"}}]}),m=i(),pe=e=>{m.value=e.api.getSelectedRows(),m.value.length===1?(c.value.commCd1=m.value[0].commCd1,c.value.commNm=m.value[0].commNm,G(),O.value=!0,R.value=!0):m.value.length>1?(O.value=!0,J.value=!1,R.value=!1,c.value.commCd1="",c.value.commNm="",G()):(O.value=!1,R.value=!1,c.value.commCd1="",c.value.commNm="",G())},fe=e=>{m.value=e.api.getSelectedRows(),m.value.length===1?E.value=!0:m.value.length>1?(E.value=!0,k.value=!1):E.value=!1},T=()=>{o.value=[];for(let e=0;N.value.length>e;e++)JSON.stringify(N.value[e])!==JSON.stringify(u.rows[e])&&u.rows[e].iuD==="U"&&o.value.push(u.rows[e]);o.value.length>0&&(J.value=!0)},U=()=>{o.value=[];for(let e=0;Q.value.length>e;e++)JSON.stringify(Q.value[e])!==JSON.stringify(d.rows[e])&&d.rows[e].iuD==="U"&&o.value.push(d.rows[e]);o.value.length>0&&(k.value=!0)},j=i(null),F=i(null);Ne(()=>{j.value="multiple",F.value="multiple",B()});const ve=()=>{o.value=[];const e=0,l={commCd1:"",oldCommCd1:"",commNm:"",commEtc:"",cnt:0,useYn:"Y",explains:"",iuD:"I"};u.rows.splice(e,0,l),C.value.setRowData(u.rows),C.value.setFocusedCell(e,"commCd1")},he=()=>{k.value=!0,o.value=[];const e=0,l={commCd2:"",oldCommCd2:"",commNm:"",commEtc:"",cnt:0,useYn:"Y",explains:"",iuD:"I"};d.rows.splice(e,0,l),y.value.setRowData(d.rows),y.value.setFocusedCell(e,"commCd2")},ge=()=>{v.dialog({dark:!0,title:"\uC790\uB8CC\uC0AD\uC81C(\uC804\uCCB4)",html:!0,message:"\uC120\uD0DD\uB41C \uC790\uB8CC\uB97C \uC0AD\uC81C\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?<br> \uC0AD\uC81C\uC2DC \uD574\uB2F9 \uADF8\uB8F9\uC758 \uBAA8\uB4E0 \uD56D\uBAA9\uC774 \uC0AD\uC81C\uB429\uB2C8\uB2E4.",ok:{push:!0,color:"negative"},cancel:{push:!0,color:"grey-7"}}).onOk(()=>{let e=[],l=[];for(let r=0;r<m.value.length;r++){let A='{"mode":"D","data":'+JSON.stringify(m.value[r])+"}";l.push(A)}M(z.jsonFiller(e,l));const t=C.value.getSelectedRows();C.value.applyTransaction({remove:t})}).onCancel(()=>{}).onDismiss(()=>{})},Ce=()=>{v.dialog({dark:!0,title:"\uC790\uB8CC\uC0AD\uC81C",message:"\uC120\uD0DD\uB41C \uC790\uB8CC\uB97C \uC0AD\uC81C\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C? ",ok:{push:!0,color:"negative"},cancel:{push:!0,color:"grey-7"}}).onOk(()=>{let e=[],l=[];for(let r=0;r<m.value.length;r++){m.value[r].commCd1=c.value.commCd1,m.value[r].oldCommCd1=c.value.commCd1;let A='{"mode":"D","data":'+JSON.stringify(m.value[r])+"}";l.push(A)}P(z.jsonFiller(e,l));const t=y.value.getSelectedRows();y.value.applyTransaction({remove:t})}).onCancel(()=>{}).onDismiss(()=>{})},we=()=>{let e=[],l=[];for(let t=0;t<u.rows.length;t++)if(!g.exports.isEmpty(u.rows[t].commCd1)&&u.rows[t].iuD==="I"){let r='{"mode": "'+u.rows[t].iuD+'","data":'+JSON.stringify(u.rows[t])+"}";e.push(r)}for(let t=0;t<o.value.length;t++)if(!g.exports.isEmpty(o.value[t].commCd1)&&o.value[t].iuD==="U"){let r='{"mode": "'+o.value[t].iuD+'","data":'+JSON.stringify(o.value[t])+"}";e.push(r)}g.exports.isEmpty(e)&&g.exports.isEmpty(l)?v.dialog({dark:!0,title:"\uC548\uB0B4",message:"\uBCC0\uACBD\uB41C \uC790\uB8CC\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4. "}).onOk(()=>{}).onCancel(()=>{}).onDismiss(()=>{}):(M(z.jsonFiller(e,l)),setTimeout(()=>{B()},500))},xe=()=>{let e=[],l=[];for(let t=0;t<d.rows.length;t++)if(!g.exports.isEmpty(d.rows[t].commCd2)&&d.rows[t].iuD==="I"){d.rows.push("commCd1"),d.rows[t].commCd1=c.value.commCd1,d.rows[t].oldCommCd1=c.value.commCd1;let r='{"mode": "'+d.rows[t].iuD+'","data":'+JSON.stringify(d.rows[t])+"}";e.push(r)}for(let t=0;t<o.value.length;t++)if(!g.exports.isEmpty(o.value[t].commCd2)&&o.value[t].iuD==="U"){o.value[t].commCd1=c.value.commCd1,o.value[t].oldCommCd1=c.value.commCd1;let r='{"mode": "'+o.value[t].iuD+'","data":'+JSON.stringify(o.value[t])+"}";e.push(r)}g.exports.isEmpty(e)&&g.exports.isEmpty(l)?v.dialog({dark:!0,title:"\uC548\uB0B4",message:"\uBCC0\uACBD\uB41C \uC790\uB8CC\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4. "}).onOk(()=>{}).onCancel(()=>{}).onDismiss(()=>{}):(P(z.jsonFiller(e,l)),setTimeout(()=>{G()},500))},H=i(0),Se=e=>(H.value=e,{minHeight:e?`calc(100vh - ${e}px)`:"100vh"}),q=()=>{W.value=window.innerHeight-H.value-180};ke(()=>{window.removeEventListener("resize",q)}),Ge(()=>{window.addEventListener("resize",q),q()});const M=e=>{console.log("aaa::: ",JSON.stringify(e)),V.post("/api/mst/mst5090_group_save",e).then(l=>{J.value=!1;let t={};t.rtn=l.data.rtn,t.rtnMsg=l.data.rtnMsg,se.notifyView(t)}).catch(l=>{console.log("error: ",l)})},P=e=>{V.post("/api/mst/mst5090_save",e).then(l=>{k.value=!1;let t={};t.rtn=l.data.rtn,t.rtnMsg=l.data.rtnMsg,se.notifyView(t)}).catch(l=>{console.log("error: ",l)})},B=async()=>{try{const e=await V.post("/api/mst/mst5090_list",{});u.rows=e.data.data,N.value=JSON.parse(JSON.stringify(e.data.data)),o.value=[]}catch(e){console.error("Error fetching users:",e)}},G=async()=>{try{const e=await V.post("/api/mst/mst5090_select",{paramCommCd1:c.value.commCd1});d.rows=e.data.data,Q.value=JSON.parse(JSON.stringify(e.data.data)),o.value=[]}catch(e){console.error("Error fetching users:",e)}};return(e,l)=>(x(),D(be,{class:"q-pa-xs-xs q-pa-sm-md","style-fn":Se},{default:n(()=>[f("div",Je,[f("div",Oe,[a(ae,{bordered:""},{default:n(()=>[a($,{class:"q-px-sm"},{default:n(()=>[a(s(p),{name:"list_alt"}),Ee]),_:1}),a(Z,{align:"right",class:"q-pa-none"},{default:n(()=>[a(L,{class:"row"},{default:n(()=>[a(s(h),{outline:"",color:"positive",dense:"",onClick:B},{default:n(()=>[a(s(p),{name:"refresh",size:"xs"})]),_:1}),a(Y),f("div",Re,[O.value?(x(),D(s(h),{key:0,outline:"",color:"negative",dense:"",onClick:ge},{default:n(()=>[a(s(p),{name:"delete",size:"xs"}),_(" \uC0AD\uC81C")]),_:1})):b("",!0),J.value?(x(),D(s(h),{key:1,outline:"",color:"primary",dense:"",onClick:we},{default:n(()=>[a(s(p),{name:"save",size:"xs"}),_(" \uC800\uC7A5 ")]),_:1})):b("",!0),a(s(h),{outline:"",color:"positive",dense:"",onClick:ve},{default:n(()=>[a(s(p),{name:"add",size:"xs"}),_(" \uC2E0\uADDC ")]),_:1})])]),_:1})]),_:1}),a(X,{size:"3px"}),a(K,{class:"q-pa-xs"},{default:n(()=>[f("div",{style:ee(S.value)},[a(s(oe),{ref:"myGridGroup",style:{width:"100%",height:"100%"},class:te(s(v).dark.isActive?"ag-theme-alpine-dark":"ag-theme-alpine"),columnDefs:ue.columns,rowData:u.rows,defaultColDef:re.def,rowSelection:j.value,onSelectionChanged:pe,onCellValueChanged:T,onGridReady:ie},null,8,["class","columnDefs","rowData","defaultColDef","rowSelection"])],4)]),_:1})]),_:1})]),f("div",Ve,[a(ae,{bordered:""},{default:n(()=>[a($,{class:"q-px-sm"},{default:n(()=>[a(s(p),{name:"list_alt"}),ze]),_:1}),a(Z,{align:"right",class:"q-pa-none"},{default:n(()=>[a(L,{class:"row"},{default:n(()=>[a(s(h),{outline:"",color:"positive",dense:"",onClick:G},{default:n(()=>[a(s(p),{name:"refresh",size:"xs"})]),_:1}),a(Y),f("div",Qe,le(c.value.commCd1)+" : "+le(c.value.commNm),1),a(Y),f("div",qe,[E.value?(x(),D(s(h),{key:0,outline:"",color:"negative",dense:"",onClick:Ce},{default:n(()=>[a(s(p),{name:"delete",size:"xs"}),_(" \uC0AD\uC81C")]),_:1})):b("",!0),k.value?(x(),D(s(h),{key:1,outline:"",color:"primary",dense:"",onClick:xe},{default:n(()=>[a(s(p),{name:"save",size:"xs"}),_(" \uC800\uC7A5 ")]),_:1})):b("",!0),R.value?(x(),D(s(h),{key:2,outline:"",color:"positive",dense:"",onClick:he},{default:n(()=>[a(s(p),{name:"add",size:"xs"}),_(" \uC2E0\uADDC ")]),_:1})):b("",!0)])]),_:1})]),_:1}),a(X,{size:"3px"}),a(K,{class:"q-pa-xs"},{default:n(()=>[f("div",{style:ee(S.value)},[a(s(oe),{ref:"myGrid",style:{width:"100%",height:"100%"},class:te(s(v).dark.isActive?"ag-theme-alpine-dark":"ag-theme-alpine"),columnDefs:me.columns,rowData:d.rows,defaultColDef:ce.def,rowSelection:F.value,onSelectionChanged:fe,onCellValueChanged:U,onGridReady:de},null,8,["class","columnDefs","rowData","defaultColDef","rowSelection"])],4)]),_:1})]),_:1})])])]),_:1}))}};export{$e as default};
